<html>
<head>
<title>Coworking Around the Globe</title>
<link href="/css/homepage-styles.css" rel="stylesheet" type="text/css">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<script src="//use.typekit.net/uam2aqu.js"></script>
<script>try{Typekit.load();}catch(e){}</script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="/js/homepage-main.js" type="text/javascript"></script>
<script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBCpWY1y7do3eG1RacDVOkJ91n8SURNN7c"></script>
</head>
<body>

<div class="container">
	<div class="space">
		<h5><a href="#">Get My Space Listed</a></h5>
	</div>
</div>

<header>
	<div class="home-logo">
		<img src="img/logo.png">
	</div>
</header>
<div class="container" style="display: none">
	<div class="country">
		<select>
  			<option value="default">Select your country</option>
  			<option value="United States">United States</option>
  			<option value="Canada">Canada</option>
  			<option value="Europe">Europe</option>
  			<option value="Asia/Pacific/Middle East">Asia/Pacific/Middle East</option>
  			<option value="Oceania">Oceania</option>
  			<option value="Latin America">Latin America</option>
  			<option value="Africa">Africa</option>
		</select>
		<div class="country-icon">
			<i class="fa fa-caret-down"></i>
		</div>
	</div>
</div>


<!-- Map Section! -->

<section id="homeMap" style="display: none">
		<section id="cd-google-map">
		<!-- #google-container will contain the map  -->
		<div id="google-container"></div>
		<!-- #cd-zoom-in and #zoom-out will be used to create our custom buttons for zooming-in/out -->
		<div id="cd-zoom-in"></div>
		<div id="cd-zoom-out"></div>
		</div>
</section>
</section>

<% function cityString(city) {
    if(city.state) {
      return city.city + ", " + (city.state || "(none)");
    } else {
      return city.city;
    }
}%>

<% function cityLink(city) {
     if(city.tinyname) {
       return "/cities/" + city.tinyname;
     } else {
       return "#" + city.id + "_anchor";
     }
}%>

<% u.each(all, function(city) {
  u.each(city.locations, function(loc) {
    loc.order = Math.random();
  });
}); %>

<%
   var flatCities = u.map(all, function(c) {
     return c;
   })

   flatCities = u.sortBy(flatCities, function(v) {
     return (v.country || "") + (v.state || "") + (v.city || "");
   });

   var citiesByCountry = { };

   u.each(flatCities, function (v) {
     citiesByCountry[v.country] = citiesByCountry[v.country] || [ ];
     citiesByCountry[v.country].push(v);
   });

   console.log(citiesByCountry);
%>

<% u.each(u.keys(citiesByCountry), function(key) { %>
  <div class="container">
  	<div class="us">
  		<h3><%= key %></h3>
  	</div>
  </div>

  <div class="container">
  	<div class="gradient-line"></div>
  </div>

  <div class="container">
    <div class="state">
      <h4></h4>
      <ul>
      <% u.each(citiesByCountry[key], function(city) { %>
        <li><a href="<%= cityLink(city) %>"><%= cityString(city) %></a></li>
      <% }); %>
      </ul>
     <div class="little-line"></div>
    </div>
  </div>
<% }); %>
</body>
</html>